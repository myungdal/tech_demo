# Setup 프로젝트

TypeScript 기반 코드 자동 생성 도구입니다. DB 스키마, 패킷, ENUM 등을 분석하여 C++ 코드를 자동 생성합니다.

---

## 프로젝트 구조

```
setup/
├── app.ts                 # 메인 진입점 (명령어 라우팅)
├── Tool/                  # 개별 생성 도구
│   ├── sql_to_db.ts       # SQL → DB 적용
│   ├── db_to_code.ts      # DB → C++ 코드 생성
│   ├── setup_config.ts    # 설정 파일 생성
│   ├── setup_enum_generation.ts    # ENUM 코드 생성
│   ├── setup_packet_generation.ts  # 패킷 코드 생성
│   ├── static_db_backup.ts         # DB 백업
│   ├── static_db_restore.ts        # DB 복원
│   ├── mapeditor_export_db.ts      # 맵 에디터 → DB
│   ├── mapeditor_import_db.ts      # DB → 맵 에디터
│   └── client_code_auto_generator_*.ts  # 클라이언트 코드 생성
├── Util/                  # 유틸리티
│   ├── db.ts              # DB 연결 관리
│   ├── file.ts            # 파일 I/O
│   └── log.ts             # 로깅
├── package.json           # npm 의존성
└── tsconfig.json          # TypeScript 설정
```

---

## 주요 기능

### DB 관련

| 명령어 | 설명 |
|--------|------|
| `sql_to_db_sp` | 저장 프로시저 SQL → DB 적용 |
| `sql_to_db_table` | 테이블 정의 SQL → DB 적용 |
| `db_to_code_cpp` | DB 스키마 → C++ 코드 생성 |
| `db_to_code_sql` | DB 스키마 → SQL 파일 생성 |
| `db_to_code_txt` | DB 스키마 → 텍스트 문서 생성 |

### DB 백업/복원

| 명령어 | 설명 |
|--------|------|
| `dumpStaticDb` | Static DB 백업 |
| `restoreStaticDb` | Static DB 복원 |
| `dumpUserDb` | User DB 백업 |
| `restoreUserDb` | User DB 복원 |
| `dumpMainDb` | Main DB 백업 |
| `restoreMainDb` | Main DB 복원 |

### 코드 생성

| 명령어 | 설명 |
|--------|------|
| `setup_config` | 설정 파일 생성 (config.xlsx → C++) |
| `setup_enum_generation` | ENUM 생성 (enum.xlsx → C++) |
| `setup_packet_generation` | 패킷 생성 (packet.xlsx → C++) |
| `client_code_auto_generator` | 클라이언트 전용 코드 생성 |

### 맵 에디터

| 명령어 | 설명 |
|--------|------|
| `mapeditor_export_db` | 맵 데이터 → DB export |
| `mapeditor_import_db` | DB → 맵 에디터 import |

---

## 사용법

### 직접 실행

```bash
cd setup
node app.js <명령어>
```

예시:
```bash
node app.js setup_packet_generation
node app.js db_to_code_cpp
```

### bat 스크립트 사용 (권장)

`bat/` 폴더의 스크립트를 통해 실행합니다:

```batch
cd bat
generate_all.bat          # 전체 생성
generate_server.bat       # 서버 코드 생성
generate_client.bat       # 클라이언트 코드 생성
```

---

## 빌드

TypeScript 소스 수정 후 JavaScript로 컴파일:

```batch
cd bat
compile_setup.bat
```

또는:

```bash
cd setup
npm run build
```

---

## 생성 결과물

자동 생성된 코드는 `autoGenerated` 폴더에 저장됩니다:

| 대상 | 경로 |
|------|------|
| 서버 패킷 | `server/serverEngine/Packet/NetworkPacketAutoGenerated/` |
| 서버 ENUM | `server/serverEngine/Packet/EnumAutoGenerated/` |
| 서버 DB 코드 | `server/serverEngine/Db/DbAutoGenerated/` |
| 클라이언트 패킷 | `client/Client/Source/Packet/NetworkPacketAutoGenerated/` |
| 클라이언트 ENUM | `client/Client/Source/Packet/EnumAutoGenerated/` |

> **주의:** `autoGenerated` 폴더의 파일은 직접 수정하지 마세요. 수정사항은 재생성 시 덮어씁니다.

---

## 생성 로그

생성된 파일 목록은 `Build/output/setup.log`에 기록됩니다:

```
2024-01-15T10:30:00.000Z	WRITE	server/serverEngine/Packet/NetworkPacketAutoGenerated/PACKET_CD.h
2024-01-15T10:30:00.010Z	WRITE	server/serverEngine/Packet/NetworkPacketAutoGenerated/PACKET_CD.cpp
...
```

---

## 의존성

- Node.js 18+
- TypeScript 5+
- MySQL 8+

npm 의존성 설치:
```bash
cd setup
npm install
```

---

## 연관 문서

- 배치 스크립트: `bat/README.md`
- 인코딩 규칙: `power_shell/README.md`
- 프로젝트 규칙: 루트 `.cursorrules`
