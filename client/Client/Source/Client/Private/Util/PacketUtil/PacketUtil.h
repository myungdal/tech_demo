// ============================================================================
// myungdal tech-demo project
// 
// Author: 안명달 (Myungdal Ahn)
// Email: mooondal@gmail.com
// GitHub: https://github.com/myungdal/tech_demo.git
// ============================================================================


#pragma once

#include "Packet/NetworkPacketAutoGenerated/PACKET_MC.h"
#include "Packet/NetworkPacketAutoGenerated/PACKET_FC.h"
#include "Packet/NetworkPacketAutoGenerated/PACKET_DC.h"
#include "Packet/NetworkPacketAutoGenerated/PACKET_GC.h"
#include "Packet/NetworkPacketAutoGenerated/PACKET_BC.h"


class NetworkPacket;
class USER_DATA;
class USER_DATA;

namespace PacketUtil
{
	bool ValidatePacket(const NetworkPacket& rp);

	bool IsReqPacket(const NetworkPacket& rp);
	bool IsAckPacket(const NetworkPacket& rp);

	template <typename _Owner>
	HandleResult DispatchPacket(_Owner* owner, NetworkPacket& rp)
	{
		{
			const HandleResult handleResult = DispatchPacketMC(0, owner, rp);

			if (handleResult != HandleResult::NOT_EXISTS)
				return handleResult;
		}
		{
			const HandleResult handleResult = DispatchPacketFC(0, owner, rp);

			if (handleResult != HandleResult::NOT_EXISTS)
				return handleResult;
		}
		{
			const HandleResult handleResult = DispatchPacketDC(0, owner, rp);

			if (handleResult != HandleResult::NOT_EXISTS)
				return handleResult;
		}
		{
			const HandleResult handleResult = DispatchPacketGC(0, owner, rp);

			if (handleResult != HandleResult::NOT_EXISTS)
				return handleResult;
		}
		{
			const HandleResult handleResult = DispatchPacketBC(0, owner, rp);

			if (handleResult != HandleResult::NOT_EXISTS)
				return handleResult;
		}

		return HandleResult::NOT_EXISTS;
	}

	void CacheUserData(const USER_DATA& rp);
	void CacheUserAssetDelta(const USER_DATA& rp);
}
