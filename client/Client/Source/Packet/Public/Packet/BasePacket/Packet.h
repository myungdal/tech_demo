// ============================================================================
// myungdal tech-demo project
// 
// Author: 안명달 (Myungdal Ahn)
// Email: mooondal@gmail.com
// GitHub: https://github.com/myungdal/tech_demo.git
// ============================================================================

#pragma once

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Packet
// 네트워크 패킷의 기본 구조를 정의합니다.
// 모든 패킷은 이 클래스를 상속받습니다.
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#pragma pack(push, 1)
class Packet
{
	friend class PacketWriter;

protected:
	// [예외] 자동 생성 패킷 클래스(NetworkPacketAutoGenerated 등)에서 직접 접근하므로 protected
	PacketType mPacketType = INVALID_PACKET_TYPE;				// 패킷 타입
	PacketSize mPacketSize = static_cast<PacketSize>(sizeof(Packet));	// 패킷 크기
	PacketTraitType mPacketTrait = INVALID_PACKET_TRAIT_TYPE;	// 패킷 특성

public:
	// 패킷 버퍼 포인터 반환
	const uint8_t* GetPacketBufPtr() const noexcept { return reinterpret_cast<const uint8_t*>(this); }
	uint8_t* RefPacketBufPtr() noexcept { return reinterpret_cast<uint8_t*>(this); }

	// 패킷 타입 접근자
	PacketType GetPacketType() const noexcept { return mPacketType; }
	PacketType& RefPacketType() noexcept { return mPacketType; }

	// 패킷 크기 반환
	PacketSize GetPacketSize() const noexcept { return mPacketSize; }

	// 패킷 특성 반환
	PacketTraitType GetPacketTrait() const noexcept { return mPacketTrait; }
};
#pragma pack(pop)

