# ì•„í‚¤í…ì²˜ ìƒì„¸

## ğŸ“ ì‹œìŠ¤í…œ êµ¬ì„±ë„

```
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚   Load Balancer â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                     â”‚                     â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  FrontServer  â”‚     â”‚  FrontServer  â”‚     â”‚  FrontServer  â”‚
      â”‚   (Gateway)   â”‚     â”‚   (Gateway)   â”‚     â”‚   (Gateway)   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚    RabbitMQ     â”‚
                           â”‚  (Message Bus)  â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                     â”‚                     â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  MainServer   â”‚     â”‚  MainServer   â”‚     â”‚   DbServer    â”‚
      â”‚   (Game)      â”‚     â”‚   (Game)      â”‚     â”‚   (Storage)   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                                                  â”‚   Database    â”‚
                                                  â”‚ (MySQL/PGSQL) â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ì„œë²„ ëª¨ë“ˆ êµ¬ì¡°

### ServerEngine (ê³µìš© ì—”ì§„)

```
ServerEngine/
â”œâ”€â”€ Core/           # TLS, Lock, Clock, Exception
â”œâ”€â”€ Worker/         # Worker Thread ê´€ë¦¬
â”œâ”€â”€ Network/        # Socket, IOCP ë„¤íŠ¸ì›Œí¬
â”œâ”€â”€ Db/             # DB Connection, Session
â”œâ”€â”€ Log/            # ë¡œê¹… ì‹œìŠ¤í…œ
â”œâ”€â”€ App/            # AppBase, ì„¤ì • ê´€ë¦¬
â”œâ”€â”€ Util/           # ìœ í‹¸ë¦¬í‹° (String, Time, Packet, Db)
â”œâ”€â”€ Packet/         # íŒ¨í‚· ì •ì˜ (ìë™ ìƒì„±)
â””â”€â”€ Common/         # Random, Stat, Math ë“±
```

### C++20 ëª¨ë“ˆ ì‹œìŠ¤í…œ

```cpp
// ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²• - ê²½ëŸ‰ ëª¨ë“ˆ import
import MainServer;           // í”„ë¡œì íŠ¸ ëª¨ë“ˆ
import ServerEnginePacket;   // StaticData, UserCache, Doc/DocLookup

// ê¸ˆì§€ - ìš°ì‚° ëª¨ë“ˆ (obj 4GB ì´ˆê³¼)
// import ServerEngine;      // âŒ C1605 ì—ëŸ¬ ë°œìƒ
```

### ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ëŸ‰ ëª¨ë“ˆ

| ëª¨ë“ˆ | ë‚´ìš© |
|------|------|
| `ServerEngineCore` | TLS, Lock, Clock, Exception |
| `ServerEngineWorker` | Worker, Thread |
| `ServerEngineDb` | DbConnection, DbSession |
| `ServerEngineNetwork` | Socket, Network |
| `ServerEngineLog` | Log, LogWriter |
| `ServerEngineApp` | AppBase, AppConfig, Http |
| `ServerEngineUtil` | StringUtil, TimeUtil ë“± |
| `ServerEnginePacket` | StaticData, UserCache, Doc/DocLookup |
| `ServerEngineCommon` | Random, Stat, Math, FlowControlScript |

---

## ğŸ“¦ ì½”ë“œ ìë™ ìƒì„± ì‹œìŠ¤í…œ

### ìƒì„± íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Resource   â”‚â”€â”€â”€â”€â–ºâ”‚   Generator  â”‚â”€â”€â”€â”€â–ºâ”‚  Generated   â”‚
â”‚  (xlsx/sql)  â”‚     â”‚  (setup.exe) â”‚     â”‚    Code      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

resource/                                  autoGenerated/
â”œâ”€â”€ packet.xlsx  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”œâ”€â”€ Packet/
â”œâ”€â”€ enum.xlsx    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”œâ”€â”€ Enum/
â”œâ”€â”€ config.xlsx  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”œâ”€â”€ Config/
â””â”€â”€ db/*.sql     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â””â”€â”€ Db/
```

### ìƒì„± ëª…ë ¹ì–´

```powershell
# ì „ì²´ ìƒì„±
.\bat\generate_all.bat

# ì„œë²„ë§Œ
.\bat\generate_server.bat

# í´ë¼ì´ì–¸íŠ¸ë§Œ
.\bat\generate_client.bat
```

### ìë™ ìƒì„± íŒŒì¼ ê·œì¹™

> âš ï¸ **ì¤‘ìš”**: ìë™ ìƒì„± íŒŒì¼ì€ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!

- í´ë”ëª…ì— `autoGenerated` í¬í•¨ â†’ ìë™ ìƒì„± í´ë”
- íŒŒì¼ëª…ì— `autoGenerated` í¬í•¨ â†’ ìë™ ìƒì„± íŒŒì¼
- ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ **ì›ë³¸ ë¦¬ì†ŒìŠ¤**ë¥¼ ìˆ˜ì • í›„ ì¬ìƒì„±

---

## ğŸ—ƒï¸ DB êµ¬ì¡°

### í´ë” êµ¬ì„±

```
resource/db/
â”œâ”€â”€ user/    # ìœ ì € ê´€ë ¨ í…Œì´ë¸”
â”œâ”€â”€ static/  # ì •ì  ë°ì´í„° í…Œì´ë¸”
â”œâ”€â”€ main/    # ë©”ì¸ ì„œë²„ í…Œì´ë¸”
â””â”€â”€ log/     # ë¡œê·¸ í…Œì´ë¸”
```

### ì‘ì—… íë¦„

```
1. resource/db/ì— SQL ìŠ¤í‚¤ë§ˆ ì‘ì„±
2. ì‚¬ìš©ì ê²€í†  ìš”ì²­
3. ìŠ¹ì¸ í›„ bat/dbAutomation/ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
4. ìë™ ìƒì„±ëœ CRUD ì½”ë“œ ì‚¬ìš©
```

---

## ğŸ“¡ íŒ¨í‚· ì‹œìŠ¤í…œ

### íŒ¨í‚· ì •ì˜ (packet.xlsx)

| íŒ¨í‚·ëª… | ë°©í–¥ | í•„ë“œ |
|--------|------|------|
| `REQ_LOGIN` | Câ†’S | userId, password |
| `RES_LOGIN` | Sâ†’C | result, sessionKey |
| `NOTIFY_CHAT` | Sâ†’C | senderId, message |

### ìƒì„±ë˜ëŠ” ì½”ë“œ

```cpp
// ì„œë²„ (.cppì—ì„œ import)
import ServerEnginePacketAutoGenerated;

// í´ë¼ì´ì–¸íŠ¸ (ê¸°ì¡´ include ë°©ì‹)
#include "Packet/NetworkPacketAutoGenerated/PACKET_LOGIN.h"
```

### í—¤ë”ì—ì„œ íŒ¨í‚· ì‚¬ìš©

```cpp
// í—¤ë”ì—ì„œëŠ” forward declaration ì‚¬ìš©
#include "Packet/NetworkPacketAutoGenerated/PacketFwd.h"

// cppì—ì„œ ì™„ì „í•œ ì •ì˜ import
import ServerEnginePacketAutoGenerated;
```

---

## ğŸ” ë„¤ì´ë° ì»¨ë²¤ì…˜

### í´ë˜ìŠ¤/í•¨ìˆ˜

```cpp
class MainServerApp;          // PascalCase
void Initialize();            // PascalCase
```

### ë³€ìˆ˜

```cpp
int32_t mCount = 0;           // m + PascalCase (ë©¤ë²„)
inline auto gInstance = ...;  // g + PascalCase (ì „ì—­)
thread_local auto tClock = ...;  // t + PascalCase (TLS)
```

### ìƒìˆ˜/Enum

```cpp
constexpr int MAX_BUFFER = 1024;  // ALL_CAPS

enum class IoType : uint8_t
{
    NONE = 0,    // ALL_CAPS
    ACCEPT,
    MAX
};
```

---

## ğŸ“ ì½”ë”© ìŠ¤íƒ€ì¼

### ë“¤ì—¬ì“°ê¸°

- **íƒ­(Tab)** ì‚¬ìš© (ìŠ¤í˜ì´ìŠ¤ ì•„ë‹˜)
- íƒ­ í¬ê¸°: 4

### ì¤‘ê´„í˜¸ (Allman ìŠ¤íƒ€ì¼)

```cpp
class MyClass
{
public:
    void Method()
    {
        if (condition)
        {
            // ì½”ë“œ
        }
    }
};
```

### íŒŒì¼ ì¸ì½”ë”©

- **UTF-8 with BOM**
- **CRLF** ì¤„ë°”ê¿ˆ
